import json

# Clase para representar una mascota
class Mascota:
    def __init__(self, nombre, especie, raza, edad, sexo, dueÃ±o, telefono):
        self.nombre = nombre
        self.especie = especie
        self.raza = raza
        self.edad = edad
        self.sexo = sexo
        self.dueÃ±o = dueÃ±o
        self.telefono = telefono

    def to_dict(self):
        return self.__dict__

# Guardar datos en un archivo JSON
def guardar_en_archivo(lista_mascotas, archivo):
    with open(archivo, "w") as f:
        json.dump([mascota.to_dict() for mascota in lista_mascotas], f, indent=4)
    print("âœ”ï¸ Datos guardados exitosamente en el archivo.")

# Cargar datos desde un archivo JSON
def cargar_desde_archivo(archivo):
    try:
        with open(archivo, "r") as f:
            return [Mascota(**datos) for datos in json.load(f)]
    except FileNotFoundError:
        return []

# Agregar una mascota a la lista
def agregar_mascota(lista, mascota):
    for m in lista:
        if m.nombre.lower() == mascota.nombre.lower():
            print(f"â— La mascota '{mascota.nombre}' ya estÃ¡ registrada.")
            return
    lista.append(mascota)
    print(f"\nâœ”ï¸ Los datos de '{mascota.nombre}' fueron exitosamente agregados. ğŸ¤—ğŸ¾")

def quicksort(lista):
    if len(lista) <= 1:
        return lista
    else:
        pivot = lista[0]
        menores = [m for m in lista[1:] if m.nombre.lower() <= pivot.nombre.lower()]
        mayores = [m for m in lista[1:] if m.nombre.lower() > pivot.nombre.lower()]
        return quicksort(menores) + [pivot] + quicksort(mayores)

# Mostrar mascotas ordenadas alfabÃ©ticamente
def mostrar_mascotas(lista):
    if not lista:
        print("ğŸ“­ No hay mascotas registradas.")
        return
    # manera en la que se muestra los datos de las mascotas ya ordenadas de manera alfabetica
    print("\nğŸ¾ Lista de Mascotas Ordenada:\n")
    lista_ordenada = quicksort(lista)
    for mascota in lista_ordenada:
        print(f"---------------------------------- ") 
        print(f"ğŸ¾ Nombre: {mascota.nombre}") 
        print(f"ğŸ¾ Especie: {mascota.especie}")
        print(f"ğŸ¾ Raza: {mascota.raza} ") 
        print(f"ğŸ¾ Edad: {mascota.edad} aÃ±os") 
        print(f"ğŸ¾ Sexo: {mascota.sexo}  ") 
        print(f"ğŸ¾ DueÃ±o: {mascota.dueÃ±o} ") 
        print(f"ğŸ¾ TelÃ©fono: {mascota.telefono}\n") 
        print(f"---------------------------------- ") 

# Eliminar los datos de una mascota de la lista
def eliminar_mascota(lista, nombre):
    for mascota in lista:
        if mascota.nombre.lower() == nombre.lower():
            lista.remove(mascota)
            print(f"âœ”ï¸ Los datos de'{nombre}' fueron exitosamente eliminados.")
            return
    print(f"âŒ No se encontrÃ³ una mascota con el nombre '{nombre}'.")

# esta es la funciÃ³n principal para la interacciÃ³n
def principal():
    archivo = "mascotas.json"
    mascotas = cargar_desde_archivo(archivo)

    while True:
        print("\n ğŸ¦´ğŸ¦´ğŸ¦´ğŸ¦´ğŸ¦´ğŸ¦´ğŸ¦´ğŸ¦´ğŸ¦´ğŸ¦´ğŸ¦´")
        print("\nVETERINARIA 24/7ğŸ¥ ")
        print("ğŸ¾GESTIÃ“N DE DATOS DE MASCOTASğŸ¾\n")

        print("1ï¸âƒ£  Agregar mascota")
        print("2ï¸âƒ£  Mostrar mascotas ordenadas")
        print("3ï¸âƒ£  Eliminar una mascota")
        print("4ï¸âƒ£  Guardar datos y salir")

        opcion = input("Elije una opciÃ³n: ")

        if opcion == "1":
            nombre = input("ğŸ¾ Nombre de la mascota: ")
            especie = input("ğŸ¦´ Especie (Perro, Gato, etc.): ")
            raza = input("ğŸ• Raza: ")
            edad = int(input("ğŸ‚ Edad: "))
            sexo = input("âš§ Sexo (Macho o Hembra): ")
            dueÃ±o = input("ğŸ‘¤ Nombre del dueÃ±o: ")
            telefono = input("ğŸ“ TelÃ©fono del dueÃ±o: ")
            nueva_mascota = Mascota(nombre, especie, raza, edad, sexo, dueÃ±o, telefono)
            agregar_mascota(mascotas, nueva_mascota)

        elif opcion == "2":
            mostrar_mascotas(mascotas)

        elif opcion == "3":
            nombre = input("âŒğŸ” Ingrese el nombre de la mascota a eliminar: ")
            eliminar_mascota(mascotas, nombre)
        elif opcion == "4":
            guardar_en_archivo(mascotas, archivo)
            print("Todos los datos ingresados, han sido exitosamente guaradados Â¡Chaitoo! ğŸ‘‹")
            
            break

        else:
            print("â— OpciÃ³n invÃ¡lida. Intenta nuevamente.")

principal()
